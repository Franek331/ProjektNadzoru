<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:RozpoznawanieMatwarzy.ViewModels"
             xmlns:converters="clr-namespace:RozpoznawanieMatwarzy.Converters"
             x:Class="RozpoznawanieMatwarzy.Views.StronaRejestracji"
             Title="Rejestracja">
    <ContentPage.Resources>
        <ResourceDictionary>
            <converters:IsNotNullOrEmptyConverter x:Key="IsNotNullOrEmptyConverter"/>
        </ResourceDictionary>
    </ContentPage.Resources>
    <ContentPage.BindingContext>
        <viewmodels:ModelRejestracji />
    </ContentPage.BindingContext>
    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="15">
            <!-- ZdjÄ™cie -->
            <Frame BorderColor="Gray" CornerRadius="10" Padding="0" HeightRequest="300" BackgroundColor="LightGray">
                <Image Source="{Binding WybraneZdjecie}" Aspect="AspectFit" HeightRequest="280" />
            </Frame>

            <!-- Przyciski do zdjÄ™cia -->
            <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                <Button Grid.Column="0" Text="ðŸ“¸ ZdjÄ™cie" Command="{Binding ZrobZdjecieCommand}" 
                        BackgroundColor="#2196F3" TextColor="White" />
                <Button Grid.Column="1" Text="ðŸ–¼ï¸ Galeria" Command="{Binding WybierzZGaleriiCommand}" 
                        BackgroundColor="#4CAF50" TextColor="White" />
            </Grid>

            <!-- Dane osobowe -->
            <Label Text="ImiÄ™:" FontSize="16" FontAttributes="Bold" Margin="0,10,0,0" />
            <Entry Placeholder="WprowadÅº imiÄ™..." Text="{Binding Imie}" FontSize="16" />

            <Label Text="Nazwisko:" FontSize="16" FontAttributes="Bold" Margin="0,10,0,0" />
            <Entry Placeholder="WprowadÅº nazwisko..." Text="{Binding Nazwisko}" FontSize="16" />

            <Label Text="PESEL (ID):" FontSize="16" FontAttributes="Bold" Margin="0,10,0,0" />
            <Entry Placeholder="WprowadÅº 11-cyfrowy PESEL..." Text="{Binding Pesel}" FontSize="16" 
                   Keyboard="Numeric" MaxLength="11" />

            <Label Text="Data urodzenia:" FontSize="16" FontAttributes="Bold" Margin="0,10,0,0" />
            <DatePicker Date="{Binding DataUrodzenia}" FontSize="16" />

            <Label Text="PÅ‚eÄ‡:" FontSize="16" FontAttributes="Bold" Margin="0,10,0,0" />
            <Picker SelectedItem="{Binding Plec}" FontSize="16" Title="Wybierz pÅ‚eÄ‡">
                <Picker.ItemsSource>
                    <x:Array Type="{x:Type x:String}">
                        <x:String>M</x:String>
                        <x:String>K</x:String>
                    </x:Array>
                </Picker.ItemsSource>
            </Picker>

            <!-- Przyciski akcji -->
            <Button Text="âœ… Zarejestruj" Command="{Binding ZarejestrujCommand}" 
                    BackgroundColor="#FF5722" TextColor="White" FontSize="18" HeightRequest="50" Margin="0,20,0,0" />

            <Button Text="ðŸŽ´ Zapisz na NFC" Command="{Binding ZapiszNaNfcCommand}" 
                    BackgroundColor="#9C27B0" TextColor="White" FontSize="14" HeightRequest="45" />

            <!-- Komunikaty -->
            <Label Text="{Binding Komunikat}" FontSize="14" TextColor="Gray" 
                   HorizontalOptions="Center" HorizontalTextAlignment="Center" />

            <Frame BorderColor="#9C27B0" CornerRadius="10" Padding="10" 
                   IsVisible="{Binding StatusNfc, Converter={StaticResource IsNotNullOrEmptyConverter}}" 
                   BackgroundColor="#F3E5F5">
                <Label Text="{Binding StatusNfc}" FontSize="14" TextColor="#9C27B0" 
                       HorizontalOptions="Center" FontAttributes="Bold" />
            </Frame>

            <!-- WskaÅºnik Å‚adowania -->
            <ActivityIndicator IsRunning="{Binding JestZajety}" IsVisible="{Binding JestZajety}" 
                               Color="#2196F3" HeightRequest="40" />
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>